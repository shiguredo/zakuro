# FAQ

## WebRTC Load Testing Tool Zakuro とはなんですか？

[株式会社時雨堂](https://shiguredo.jp) が開発/販売している [WebRTC SFU Sora](https://sora.shiguredo.jp) 専用の負荷試験ツールです。

## Zakuro は何に利用するのですか？

Sora を運用するサーバのサイジングの見積もりが目的です。
WebRTC は要求するビットレートや利用するネットワーク、送信者、受信者の数によって負荷が変わります。

そのため今まではサイジングがとても難しく、ある程度余裕のあるスペックを用意するしかありませんでした。

Zakuro を提供することで、 Sora を運用するサーバのサイジングを行えるようにするのが目的です。

## Zakuro は無料で利用できますか？

[Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0) としてソースコードを公開しています。

## Zakuro のライセンスを教えて下さい

[Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0) です。

## Zakuro に含まれている音声ファイルについて教えてください

Zakuro のスポットライト機能検証時に利用する音声ファイルには [あみたろの声素材工房](https://amitaro.net/) 様の声素材を使用しています。

## Zakuro の動作環境を教えて下さい

サーバでの用途を前提としているため Linux での動作を想定しています。

- Ubuntu 20.04 x86_64
- Ubuntu 22.04 x86_64

## Zakuro は破壊的変更を行いますか？

積極的な破壊的変更を行います。

## Zakuro を利用する際の注意点はありますか？

### ファイルディスクリプタ数

かなりの数を消費しますので、 Zakuro と Sora 両方のサーバで多めに設定することを推奨します。

### 負荷をかける対象

Zakuro は Sora に膨大な負荷をかけますので、利用する場合はとても注意してください。

ツール利用者が運用していない環境への利用は絶対に行わないようにしてください。

### サーバスペック

これは効率の良いシミュレータではなく力技で負荷を実現するツールです。

そのため、大量の CPU リソースを消費します。利用する場合は多くのコアを積んだサーバを用意してください。

## 実際のブラウザなどと異なりますか？

異なります。

ただし libwebrtc をベースにしているため、 WebRTC の挙動自体はブラウザとほぼ同じです。
さらに 1 接続 1 エンコーダを採用しているため、 1 接続が独立しています。

そのため再送や全画面要求に対してもそれぞれの接続ごとに処理を行います。

## 受信した音声や映像をデコードしていますか？

していません。負荷を削減するためデコードする前に破棄しています。

## 遅延を確認するにはどうすればいいですか？

`--game kuzushi` を利用してみてください。ブロック崩しゲームが始まります。

## エンコーダやデコーダに負荷をかけるにはどうすればいいですか？

砂嵐を生成する `--sandstorm` を利用してみてください。ただしこれは凄まじく CPU とネットワークを消費します。

## mp4 から y4m はどうやって作成すればいいですか？

FFmpeg を利用すると簡単に作成できます。

```
ffmpeg -i in.mp4 -f yuv4mpegpipe out.y4m
```

## mp4 ファイルから wav ファイルはどうやって作成すればいいですか？

```
ffmpeg -i in.mp4 -f wav -vn out.wav
```
